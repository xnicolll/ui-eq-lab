{% extends "base.html" %}

{% block content %}
<div class="content-section">
    <div class="results-container">
        <h2>Quiz Results</h2>
        <div class="score">
            <p>You got <span class="score-number">{{ correct_answers }}</span> out of 5 questions correct!</p>
        </div>

        <button class="dropdown-toggle nav-btn">Show Detailed Results</button>
        
        <div class="detailed-results" style="display: none;">
            <table class="results-table">
                <thead>
                    <tr>
                        <th>Topic</th>
                        <th>Result</th>
                    </tr>
                </thead>
                <tbody>
                    {% for answer in user_answers %}
                    <tr>
                        <td>
                            {% if answer.question_id == 1 %}
                                Pass Technique
                            {% elif answer.question_id == 2 %}
                                Pass Technique
                            {% elif answer.question_id == 3 %}
                                Boost / Cut Technique
                            {% elif answer.question_id == 4 %}
                                Treble / Bass Identification
                            {% elif answer.question_id == 5 %}
                                Low Pass Filter
                            {% endif %}
                        </td>
                        <td class="{% if answer.is_correct %}correct{% else %}incorrect{% endif %}">
                            {% if answer.is_correct %}
                                Correct
                            {% else %}
                                Incorrect
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        {% if correct_answers >= 3 %}
        <div class="success-message">
            <h3>Congratulations on completing our EQ Crash Course!</h3>
            <p>You've demonstrated a good understanding of EQ concepts.</p>
            <a href="{{ url_for('home') }}" class="nav-btn">Return Home</a>
        </div>
        {% else %}
        <div class="retry-message">
            <p>It looks like you might benefit from reviewing the material.</p>
            <a href="{{ url_for('intro') }}" class="nav-btn">Learn Again</a>
        </div>
        {% endif %}
    </div>
</div>

<style>
.results-container {
    text-align: center;
    max-width: 600px;
    margin: 0 auto;
    padding: 2rem;
}

.score {
    margin: 2rem 0;
    font-size: 1.2rem;
}

.score-number {
    font-size: 2rem;
    font-weight: bold;
    color: var(--dark);
}

.success-message, .retry-message {
    margin: 2rem 0;
}

.success-message h3 {
    color: var(--dark);
    margin-bottom: 1rem;
}

.retry-message p {
    color: var(--dark);
    margin-bottom: 1.5rem;
}

.dropdown-toggle {
    margin: 1rem 0;
    padding: 0.5rem 1.5rem;
}

.detailed-results {
    margin: 1.5rem auto;
    max-width: 400px;
}

.results-table {
    width: 100%;
    border-collapse: collapse;
    margin: 1rem 0;
}

.results-table th,
.results-table td {
    padding: 1rem;
    text-align: left;
    border-bottom: 1px solid var(--accent);
}

.results-table th {
    background-color: var(--dark);
    color: var(--light);
    font-weight: 300;
}

.results-table td.correct {
    color: #2ecc71;
}

.results-table td.incorrect {
    color: #e74c3c;
}

.detailed-results {
    opacity: 0;
    max-height: 0;
    overflow: hidden;
    transition: all 0.3s ease-in-out;
}

.detailed-results.show {
    opacity: 1;
    max-height: 500px;
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const toggleButton = document.querySelector('.dropdown-toggle');
    const detailedResults = document.querySelector('.detailed-results');
    
    toggleButton.addEventListener('click', function() {
        const isHidden = detailedResults.style.display === 'none';
        
        if (isHidden) {
            detailedResults.style.display = 'block';
            setTimeout(() => {
                detailedResults.classList.add('show');
            }, 10);
            toggleButton.textContent = 'Hide Detailed Results';
        } else {
            detailedResults.classList.remove('show');
            setTimeout(() => {
                detailedResults.style.display = 'none';
            }, 300);
            toggleButton.textContent = 'Show Detailed Results';
        }
    });
});
</script>
{% endblock %} 